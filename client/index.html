<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- Latest compiled and minified CSS -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

      <!-- Optional theme -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

      <style type="text/css">
body {
  padding-top: 40px;
  padding-bottom: 40px;
  background-color: #eee;
}

.form-details {
  max-width: 330px;
  padding: 15px;
  margin: 0 auto;
}
.form-details .form-details-heading,
.form-details .checkbox {
  margin-bottom: 10px;
}
.form-details .checkbox {
  font-weight: normal;
}
.form-details .form-control {
  position: relative;
  height: auto;
  padding: 10px;
  font-size: 16px;
}
.form-details .form-control:focus {
  z-index: 2;
}
      </style>
  </head>
  <body>



    <div class="container">

      <form class="form-details"  oninput="startChrono()" method="post">

        <h2 class="form-details-heading">Details</h2>

        <label for="inputEmail" class="sr-only">Email address</label>
        <input type="email" id="inputEmail" class="form-control" oncopy="detectCopy(inputEmail)" onpaste="detectPaste(inputEmail)"
        placeholder="Email address" required autofocus>

        <label for="inputCardNumber" class="sr-only">Card Number</label>
        <input type="text" id="inputCardNumber" class="form-control" oncopy="detectCopy(inputCardNumber)" onpaste="detectPaste(inputCardNumber)"
        placeholder="Card Number" required>

        <label for="inputCVV" class="sr-only">CVV</label>
        <input type="text" id="inputCVV" class="form-control" oncopy="detectCopy(inputCVV)" onpaste="detectPaste(inputCVV)"
        placeholder="Security Code" required>

        <div class="checkbox">
          <label>
            <input type="checkbox" value="agree"> Agree to Terms
          </label>
        </div>

        <button type="button" class="btn btn-lg btn-primary btn-block"  onclick="formSubmitted()">Submit</button>

      </form>

    </div> <!-- /container -->

    <script>

      // Detect screen resize : send the old and the new dimension after each resize operation
      $(document).ready(function(){
          var oldDimmension = {"Height":window.innerHeight,"Width":window.innerWidth}    
          $(window).resize(function(){
                var newDimension = {"Height":window.innerHeight,"Width":window.innerWidth} 
                //post to golang the old and the new 
                var event = { // the event object to sent 
                    eventType: "screenResize",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    Dimension: newDimension
                }
                console.log(event)
                // make a post to golang
                $.ajax({
                    type: "POST",
                    data :JSON.stringify(event),
                    url: "api/event",
                    contentType: "application/json"
                });
                oldDimmension = newDimension
                });
           });
      var startTyping,endTyping ; // when first character is typed & form submitted
      function startChrono() { // this fucntion will be triggred when the first character has been typed 
              startTyping = performance.now();  // get the time when the first character has been typed 
              
        } 

      function formSubmitted()
        {
          endTyping = performance.now(); // get the time when the form is submitted 
          var event = {
                    eventType: "timeTaken",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    time:Math.trunc((endTyping-startTyping)/1000)
              }
          console.log(event);
          $.ajax({
              type: "POST",
              data :JSON.stringify(event),
              url: "api/event",
              contentType: "application/json"
              });

          var email = document.getElementById("inputEmail").value;
          var cardNUmber = document.getElementById("inputCardNumber").value;
          var cvv = document.getElementById("inputCVV").value;
          var myObj = { "inputEmail":email, "inputCardNumber":cardNUmber, "inputCVV":cvv};
          console.log(myObj);

      }

      
      
      // Detect copy/paste of each field :
       function detectPaste(fieldid) {
            var event;
            switch (fieldid) {
              case inputEmail:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: true,
                    copied:false,
                    formId: "inputEmail"}
                console.log(event);
                break;
              case inputCardNumber:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: true,
                    copied:false,
                    formId: "inputCardNumber"}
                console.log(event);
                break;
              case inputCVV:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: true,
                    copied:false,
                    formId: "inputCVV"}
                console.log(event);
                break;

            }
            $.ajax({
                    type: "POST",
                    data :JSON.stringify(event),
                    url: "api/event",
                    contentType: "application/json"
                });
            }

        function detectCopy(fieldid) {
            var event;
            switch (fieldid) {
              case inputEmail:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: false,
                    copied:true,
                    formId: "inputEmail"}
                console.log(event);
                break;
              case inputCardNumber:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: false,
                    copied:true,
                    formId: "inputCardNumber"}
                console.log(event);
                break;
              case inputCVV:
                    event = {
                    eventType: "copyAndPaste",
                    websiteUrl: window.location.href ,
                    sessionId: document.cookie,
                    pasted: false,
                    copied:true,
                    formId: "inputCVV"}
                console.log(event);
                break;
            }
            $.ajax({
                    type: "POST",
                    data :JSON.stringify(event),
                    url: "api/event",
                    contentType: "application/json"
                });
            }

       



</script>
   
  </body>
</html>